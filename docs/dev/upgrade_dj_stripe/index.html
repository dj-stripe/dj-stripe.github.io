<!DOCTYPE html><!--Ux_j_XjcgvusXV2br8vv7--><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/_next/static/media/569ce4b8f30dc480-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/93f479601ee12b01-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" as="image" href="https://github.com/agusmakmun/agusmakmun.github.io/assets/7134451/d433d048-d3cf-4385-a7f6-f1890acfe206"/><link rel="preload" as="image" href="https://github.com/agusmakmun/agusmakmun.github.io/assets/7134451/6958e5a5-2e6d-4dd7-a9e3-5f067a819378"/><link rel="preload" as="image" href="https://github.com/agusmakmun/agusmakmun.github.io/assets/7134451/4b075b78-5a34-4ed5-a23a-7dd1c8884bfa"/><link rel="preload" as="image" href="https://github.com/agusmakmun/agusmakmun.github.io/assets/7134451/70ebe2d4-d780-4994-b05b-e361fc95dd3d"/><link rel="stylesheet" href="/_next/static/css/2ff57a8dc1dd022b.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/a4573f701b9eba42.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-08309892bbe354a2.js"/><script src="/_next/static/chunks/4bd1b696-cf72ae8a39fa05aa.js" async=""></script><script src="/_next/static/chunks/964-69097a61540f27b4.js" async=""></script><script src="/_next/static/chunks/main-app-b0c2b1956eab1d69.js" async=""></script><script src="/_next/static/chunks/app/layout-e2df609ea3d3ba96.js" async=""></script><script src="/_next/static/chunks/874-437a265a67d6cfee.js" async=""></script><script src="/_next/static/chunks/313-066de8fe535cc241.js" async=""></script><script src="/_next/static/chunks/app/docs/%5Bversion%5D/%5B%5B...slug%5D%5D/page-4b0116ae65eeec55.js" async=""></script><meta name="next-size-adjust" content=""/><title>dj-stripe - Stripe Made Easy for Django Developers</title><meta name="description" content="The easiest way to integrate Stripe with your Django project. Handle payments, subscriptions, and webhooks with just a few lines of code."/><script src="/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="__variable_5cfdac __variable_9a8899 antialiased"><div hidden=""><!--$--><!--/$--></div><div class="min-h-screen bg-white dark:bg-gray-900"><header class="border-b border-gray-200 dark:border-gray-800 sticky top-0 bg-white dark:bg-gray-900 z-10"><nav class="container mx-auto px-6 py-4 flex items-center justify-between"><a class="text-2xl font-bold" href="/">dj-<span class="text-stripe-blurple">stripe</span></a><div class="flex gap-6 items-center"><a class="hover:text-blue-600 transition-colors" href="/about/">About</a><a class="text-blue-600 font-semibold" href="/docs/latest/">Documentation</a><a class="hover:text-blue-600 transition-colors" href="/sponsors/">Sponsors</a><a class="hover:text-blue-600 transition-colors" href="/team/">Team</a><a class="hover:text-blue-600 transition-colors" href="/support/">Support</a><a href="https://github.com/dj-stripe/dj-stripe" class="flex items-center gap-3 px-3 py-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors text-gray-700 dark:text-gray-300" target="_blank" rel="noopener noreferrer"><i class="fab fa-github text-xl"></i><div class="flex flex-col"><span class="text-sm font-medium">dj-stripe</span><div class="flex items-center gap-3 text-xs text-gray-500 dark:text-gray-400"><span>Loading...</span></div></div></a><select class="px-3 py-1 border border-gray-300 dark:border-gray-700 rounded-md bg-white dark:bg-gray-800"><option value="dev" selected="">vdev</option></select><div class="relative"><button class="flex items-center gap-2 px-3 py-1.5 text-sm text-gray-600 dark:text-gray-400 bg-gray-100 dark:bg-gray-800 rounded-md hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg><span>Search</span><kbd class="hidden sm:inline-block px-1.5 py-0.5 text-xs bg-gray-200 dark:bg-gray-700 rounded">⌘K</kbd></button></div><button class="group relative p-2.5 rounded-full hover:bg-gray-100/80 dark:hover:bg-gray-800/80 transition-all duration-200 hover:scale-105 active:scale-95" aria-label="Switch to dark mode"><div class="absolute inset-0 rounded-full bg-gradient-to-br from-yellow-200/20 to-orange-300/20 dark:from-purple-400/20 dark:to-blue-500/20 opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div><div class="relative transition-all duration-300 "><div class="relative w-5 h-5"><svg class="w-full h-full text-amber-500 transition-all duration-300 drop-shadow-sm" fill="currentColor" viewBox="0 0 24 24"><circle cx="12" cy="12" r="4" class="animate-pulse"></circle><g class="animate-spin" style="transform-origin:12px 12px;animation-duration:8s"><path d="M12 1v2m0 18v2M4.22 4.22l1.42 1.42m12.72 12.72l1.42 1.42M1 12h2m18 0h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42" stroke="currentColor" stroke-width="2" stroke-linecap="round"></path></g></svg></div></div><div class="absolute top-full left-1/2 transform -translate-x-1/2 mt-2 px-2 py-1 text-xs text-white bg-gray-900 dark:bg-gray-700 rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap">Switch to <!-- -->dark<!-- --> mode</div></button></div></nav></header><div class="container mx-auto px-6 py-8"><div class="flex gap-8"><aside class="w-64 flex-shrink-0"><nav class="sticky top-24"><h3 class="font-semibold mb-4">Documentation</h3><ul class="space-y-2"><li><a class="block px-3 py-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors " href="/docs/dev/">Getting Started</a><ul class="ml-4 mt-2 space-y-1"><li><a class="block px-3 py-1 text-sm rounded-md hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors text-gray-600 dark:text-gray-400" href="/docs/dev/installation/">Installation</a></li><li><a class="block px-3 py-1 text-sm rounded-md hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors text-gray-600 dark:text-gray-400" href="/docs/dev/api_keys/">API Keys</a></li><li><a class="block px-3 py-1 text-sm rounded-md hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors text-gray-600 dark:text-gray-400" href="/docs/dev/api_versions/">API Versions</a></li><li><a class="block px-3 py-1 text-sm rounded-md hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors bg-blue-50 dark:bg-blue-900/20 text-blue-600" href="/docs/dev/upgrade_dj_stripe/">Upgrade Guide</a></li></ul></li><li><a class="block px-3 py-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors " href="/docs/dev/usage/">Usage</a><ul class="ml-4 mt-2 space-y-1"><li><a class="block px-3 py-1 text-sm rounded-md hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors text-gray-600 dark:text-gray-400" href="/docs/dev/usage/webhooks/">Webhooks</a></li><li><a class="block px-3 py-1 text-sm rounded-md hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors text-gray-600 dark:text-gray-400" href="/docs/dev/usage/subscribing_customers/">Subscribing Customers</a></li><li><a class="block px-3 py-1 text-sm rounded-md hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors text-gray-600 dark:text-gray-400" href="/docs/dev/usage/add_payment_method_to_customer/">Payment Methods</a></li><li><a class="block px-3 py-1 text-sm rounded-md hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors text-gray-600 dark:text-gray-400" href="/docs/dev/usage/managing_subscriptions/">Managing Subscriptions</a></li><li><a class="block px-3 py-1 text-sm rounded-md hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors text-gray-600 dark:text-gray-400" href="/docs/dev/usage/using_stripe_checkout/">Stripe Checkout</a></li><li><a class="block px-3 py-1 text-sm rounded-md hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors text-gray-600 dark:text-gray-400" href="/docs/dev/usage/manually_syncing_with_stripe/">Manual Syncing</a></li></ul></li><li><a class="block px-3 py-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors " href="/docs/dev/project/">Project</a><ul class="ml-4 mt-2 space-y-1"><li><a class="block px-3 py-1 text-sm rounded-md hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors text-gray-600 dark:text-gray-400" href="/docs/dev/project/contributing/">Contributing</a></li><li><a class="block px-3 py-1 text-sm rounded-md hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors text-gray-600 dark:text-gray-400" href="/docs/dev/project/support/">Support</a></li><li><a class="block px-3 py-1 text-sm rounded-md hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors text-gray-600 dark:text-gray-400" href="/docs/dev/project/authors/">Authors</a></li></ul></li></ul></nav></aside><main class="flex-1 max-w-4xl"><article class="prose prose-lg dark:prose-invert max-w-none"><h1>Upgrading dj-stripe Smooth and Carefully</h1>
<h2>Background</h2>
<p>In this article, we will share how to upgrade the <code>dj-stripe</code> package flawlessly and carefully.</p>
<p>!!! attention &quot;Important Note&quot;
Please keep in mind that <code>dj-stripe</code> always squashes the migration files.
Which means its migration files are completely changed, and leading to migration issues.
<strong>So, you can&#x27;t immediately upgrade your package too far, for example, from <code>2.4.0</code> to <code>2.7.0</code> because it will cause breaking changes, especially in your database migrations.</strong></p>
<h2>How to do it?</h2>
<p>For example, if your <code>dj-stripe</code> version is <code>2.4.0</code> and your migration files are referring to the old version.</p>
<p><img src="https://github.com/agusmakmun/agusmakmun.github.io/assets/7134451/d433d048-d3cf-4385-a7f6-f1890acfe206" alt="old migration file"/></p>
<p>First, you need to find which version has that old migration. For example:</p>
<ol>
<li>Search for the latest version that is closest to your package version, for example: <code>2.4.0</code> to <code>2.5.0</code>.</li>
<li>Visit this link to find it: <a href="https://github.com/dj-stripe/dj-stripe/releases">https://github.com/dj-stripe/dj-stripe/releases</a></li>
<li>Cross-check the release notes.</li>
<li>Find which dj-stripe version is still compatible with your migration file, for example: <code>0006_2_3.py</code>.</li>
<li>Find the last migration file of the latest version at <a href="https://github.com/dj-stripe/dj-stripe/tree/2.5.0/djstripe/migrations">https://github.com/dj-stripe/dj-stripe/tree/2.5.0/djstripe/migrations</a> (for example: <code>0008_2_5.py</code>) (both files must exist; if not, it means the new version is no longer compatible with your version).</li>
</ol>
<table><thead><tr><th>Old Migration</th><th>New Migration</th></tr></thead><tbody><tr><td><img src="https://github.com/agusmakmun/agusmakmun.github.io/assets/7134451/6958e5a5-2e6d-4dd7-a9e3-5f067a819378" alt="old migration"/></td><td><img src="https://github.com/agusmakmun/agusmakmun.github.io/assets/7134451/4b075b78-5a34-4ed5-a23a-7dd1c8884bfa" alt="new migration"/></td></tr></tbody></table>
<ol start="6">
<li>Update your <code>requirements.txt</code> file from <code>dj-stripe==2.4.0</code> to <code>dj-stripe==2.5.0</code></li>
<li>Run the <code>manage.py migrate djstripe</code> command <em>(this command must not fail; if it does, cross-check steps 1-6).</em></li>
</ol>
<pre><code class="hljs language-bash">(env-my-project) ➜  my-project git:(development) ✗ docker-compose -f local.yml run django python manage.py migrate djstripe
[+] Creating 3/0
 ✔ Container my-project-redis-1     Running                                                                                                                                                                                  0.0s
 ✔ Container my-project-mailhog-1   Running                                                                                                                                                                                  0.0s
 ✔ Container my-project-postgres-1  Running                                                                                                                                                                                  0.0s
PostgreSQL is available
System check identified some issues:

Operations to perform:
  Apply all migrations: djstripe
Running migrations:
  Applying djstripe.0008_2_5... OK
</code></pre>
<ol start="8">
<li>And then, after migrating it, change your migration file to refer to the new version (e.g., from <code>0006_2_3</code> to <code>0008_2_5</code>).</li>
</ol>
<p><img src="https://github.com/agusmakmun/agusmakmun.github.io/assets/7134451/70ebe2d4-d780-4994-b05b-e361fc95dd3d" alt="change migration file"/></p>
<ol start="9">
<li>Repeat the same process for higher version.</li>
</ol>
<p>If you have an issue with the Stripe version, we can also try upgrading it in the <code>requirements.txt</code> file.
Check out this issue for more information: <a href="https://github.com/dj-stripe/dj-stripe/issues/1842#issuecomment-1319185657">https://github.com/dj-stripe/dj-stripe/issues/1842#issuecomment-1319185657</a>.</p>
<pre><code class="hljs language-txt">stripe&gt;=4.0.0,&lt;5.0.0  # https://github.com/dj-stripe/dj-stripe/issues/1842#issuecomment-1319185657
</code></pre>
<h2>Conclusion</h2>
<ol>
<li>Find the closest version that compatible with your version <em>(for doing migration)</em>.</li>
<li>Update the dependency in <code>requirements.txt</code> file and then deploy it.<!-- -->
<ul>
<li>Don&#x27;t forget to run the <code>python manage.py migrate djstripe</code> command.</li>
</ul>
</li>
<li>Change your migration file to refer to the new version (e.g., from <code>0006_2_3</code> to <code>0008_2_5</code>), and then deploy it.</li>
</ol>
<h2>Alternatives</h2>
<ul>
<li><a href="https://stackoverflow.com/a/31122841">https://stackoverflow.com/a/31122841</a></li>
</ul></article></main></div></div></div><!--$--><!--/$--><script src="/_next/static/chunks/webpack-08309892bbe354a2.js" id="_R_" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[1483,[\"177\",\"static/chunks/app/layout-e2df609ea3d3ba96.js\"],\"ThemeProvider\"]\n3:I[7555,[],\"\"]\n4:I[1295,[],\"\"]\n6:I[9665,[],\"OutletBoundary\"]\n8:I[4911,[],\"AsyncMetadataOutlet\"]\na:I[9665,[],\"ViewportBoundary\"]\nc:I[9665,[],\"MetadataBoundary\"]\nd:\"$Sreact.suspense\"\nf:I[8393,[],\"\"]\n:HL[\"/_next/static/media/569ce4b8f30dc480-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/media/93f479601ee12b01-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/css/2ff57a8dc1dd022b.css\",\"style\"]\n:HL[\"/_next/static/css/a4573f701b9eba42.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"Ux_j_XjcgvusXV2br8vv7\",\"p\":\"\",\"c\":[\"\",\"docs\",\"dev\",\"upgrade_dj_stripe\",\"\"],\"i\":false,\"f\":[[[\"\",{\"children\":[\"docs\",{\"children\":[[\"version\",\"dev\",\"d\"],{\"children\":[[\"slug\",\"upgrade_dj_stripe\",\"oc\"],{\"children\":[\"__PAGE__\",{}]}]}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/2ff57a8dc1dd022b.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}],[\"$\",\"link\",\"1\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/a4573f701b9eba42.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"suppressHydrationWarning\":true,\"children\":[\"$\",\"body\",null,{\"className\":\"__variable_5cfdac __variable_9a8899 antialiased\",\"children\":[\"$\",\"$L2\",null,{\"defaultTheme\":\"system\",\"storageKey\":\"dj-stripe-theme\",\"children\":[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":404}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]}]}]]}],{\"children\":[\"docs\",[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"version\",\"dev\",\"d\"],[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"slug\",\"upgrade_dj_stripe\",\"oc\"],[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[\"__PAGE__\",[\"$\",\"$1\",\"c\",{\"children\":[\"$L5\",null,[\"$\",\"$L6\",null,{\"children\":[\"$L7\",[\"$\",\"$L8\",null,{\"promise\":\"$@9\"}]]}]]}],{},null,false]},null,false]},null,false]},null,false]},null,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[[\"$\",\"$La\",null,{\"children\":\"$Lb\"}],[\"$\",\"meta\",null,{\"name\":\"next-size-adjust\",\"content\":\"\"}]],[\"$\",\"$Lc\",null,{\"children\":[\"$\",\"div\",null,{\"hidden\":true,\"children\":[\"$\",\"$d\",null,{\"fallback\":null,\"children\":\"$Le\"}]}]}]]}],false]],\"m\":\"$undefined\",\"G\":[\"$f\",[]],\"s\":false,\"S\":true}\n"])</script><script>self.__next_f.push([1,"b:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n7:null\n"])</script><script>self.__next_f.push([1,"9:{\"metadata\":[[\"$\",\"title\",\"0\",{\"children\":\"dj-stripe - Stripe Made Easy for Django Developers\"}],[\"$\",\"meta\",\"1\",{\"name\":\"description\",\"content\":\"The easiest way to integrate Stripe with your Django project. Handle payments, subscriptions, and webhooks with just a few lines of code.\"}]],\"error\":null,\"digest\":\"$undefined\"}\n"])</script><script>self.__next_f.push([1,"e:\"$9:metadata\"\n"])</script><script>self.__next_f.push([1,"10:I[6874,[\"874\",\"static/chunks/874-437a265a67d6cfee.js\",\"313\",\"static/chunks/313-066de8fe535cc241.js\",\"967\",\"static/chunks/app/docs/%5Bversion%5D/%5B%5B...slug%5D%5D/page-4b0116ae65eeec55.js\"],\"\"]\n11:I[7283,[\"874\",\"static/chunks/874-437a265a67d6cfee.js\",\"313\",\"static/chunks/313-066de8fe535cc241.js\",\"967\",\"static/chunks/app/docs/%5Bversion%5D/%5B%5B...slug%5D%5D/page-4b0116ae65eeec55.js\"],\"GitHubRepoWidget\"]\n12:I[6690,[\"874\",\"static/chunks/874-437a265a67d6cfee.js\",\"313\",\"static/chunks/313-066de8fe535cc241.js\",\"967\",\"static/chunks/app/docs/%5Bversion%5D/%5B%5B...slug%5D%5D/page-4b0116ae65eeec55.js\"],\"VersionSelector\"]\n13:I[1000,[\"874\",\"static/chunks/874-437a265a67d6cfee.js\",\"313\",\"static/chunks/313-066de8fe535cc241.js\",\"967\",\"static/chunks/app/docs/%5Bversion%5D/%5B%5B...slug%5D%5D/page-4b0116ae65eeec55.js\"],\"Search\"]\n14:I[6688,[\"874\",\"static/chunks/874-437a265a67d6cfee.js\",\"313\",\"static/chunks/313-066de8fe535cc241.js\",\"967\",\"static/chunks/app/docs/%5Bversion%5D/%5B%5B...slug%5D%5D/page-4b0116ae65eeec55.js\"],\"ThemeToggle\"]\n"])</script><script>self.__next_f.push([1,"5:[\"$\",\"div\",null,{\"className\":\"min-h-screen bg-white dark:bg-gray-900\",\"children\":[[\"$\",\"header\",null,{\"className\":\"border-b border-gray-200 dark:border-gray-800 sticky top-0 bg-white dark:bg-gray-900 z-10\",\"children\":[\"$\",\"nav\",null,{\"className\":\"container mx-auto px-6 py-4 flex items-center justify-between\",\"children\":[[\"$\",\"$L10\",null,{\"href\":\"/\",\"className\":\"text-2xl font-bold\",\"children\":[\"dj-\",[\"$\",\"span\",null,{\"className\":\"text-stripe-blurple\",\"children\":\"stripe\"}]]}],[\"$\",\"div\",null,{\"className\":\"flex gap-6 items-center\",\"children\":[[\"$\",\"$L10\",null,{\"href\":\"/about\",\"className\":\"hover:text-blue-600 transition-colors\",\"children\":\"About\"}],[\"$\",\"$L10\",null,{\"href\":\"/docs/latest\",\"className\":\"text-blue-600 font-semibold\",\"children\":\"Documentation\"}],[\"$\",\"$L10\",null,{\"href\":\"/sponsors\",\"className\":\"hover:text-blue-600 transition-colors\",\"children\":\"Sponsors\"}],[\"$\",\"$L10\",null,{\"href\":\"/team\",\"className\":\"hover:text-blue-600 transition-colors\",\"children\":\"Team\"}],[\"$\",\"$L10\",null,{\"href\":\"/support\",\"className\":\"hover:text-blue-600 transition-colors\",\"children\":\"Support\"}],[\"$\",\"$L11\",null,{}],[\"$\",\"$L12\",null,{\"currentVersion\":\"dev\",\"versions\":[\"dev\"],\"currentPath\":\"upgrade_dj_stripe\"}],[\"$\",\"$L13\",null,{}],[\"$\",\"$L14\",null,{}]]}]]}]}],[\"$\",\"div\",null,{\"className\":\"container mx-auto px-6 py-8\",\"children\":[\"$\",\"div\",null,{\"className\":\"flex gap-8\",\"children\":[[\"$\",\"aside\",null,{\"className\":\"w-64 flex-shrink-0\",\"children\":[\"$\",\"nav\",null,{\"className\":\"sticky top-24\",\"children\":[[\"$\",\"h3\",null,{\"className\":\"font-semibold mb-4\",\"children\":\"Documentation\"}],[\"$\",\"ul\",null,{\"className\":\"space-y-2\",\"children\":[[\"$\",\"li\",\"\",{\"children\":[[\"$\",\"$L10\",null,{\"href\":\"/docs/dev\",\"className\":\"block px-3 py-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors \",\"children\":\"Getting Started\"}],[\"$\",\"ul\",null,{\"className\":\"ml-4 mt-2 space-y-1\",\"children\":[[\"$\",\"li\",\"/installation\",{\"children\":[\"$\",\"$L10\",null,{\"href\":\"/docs/dev/installation\",\"className\":\"block px-3 py-1 text-sm rounded-md hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors text-gray-600 dark:text-gray-400\",\"children\":\"Installation\"}]}],[\"$\",\"li\",\"/api_keys\",{\"children\":[\"$\",\"$L10\",null,{\"href\":\"/docs/dev/api_keys\",\"className\":\"block px-3 py-1 text-sm rounded-md hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors text-gray-600 dark:text-gray-400\",\"children\":\"API Keys\"}]}],[\"$\",\"li\",\"/api_versions\",{\"children\":[\"$\",\"$L10\",null,{\"href\":\"/docs/dev/api_versions\",\"className\":\"block px-3 py-1 text-sm rounded-md hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors text-gray-600 dark:text-gray-400\",\"children\":\"API Versions\"}]}],[\"$\",\"li\",\"/upgrade_dj_stripe\",{\"children\":[\"$\",\"$L10\",null,{\"href\":\"/docs/dev/upgrade_dj_stripe\",\"className\":\"block px-3 py-1 text-sm rounded-md hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors bg-blue-50 dark:bg-blue-900/20 text-blue-600\",\"children\":\"Upgrade Guide\"}]}]]}]]}],[\"$\",\"li\",\"/usage\",{\"children\":[[\"$\",\"$L10\",null,{\"href\":\"/docs/dev/usage\",\"className\":\"block px-3 py-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors \",\"children\":\"Usage\"}],[\"$\",\"ul\",null,{\"className\":\"ml-4 mt-2 space-y-1\",\"children\":[[\"$\",\"li\",\"/usage/webhooks\",{\"children\":[\"$\",\"$L10\",null,{\"href\":\"/docs/dev/usage/webhooks\",\"className\":\"block px-3 py-1 text-sm rounded-md hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors text-gray-600 dark:text-gray-400\",\"children\":\"Webhooks\"}]}],[\"$\",\"li\",\"/usage/subscribing_customers\",{\"children\":[\"$\",\"$L10\",null,{\"href\":\"/docs/dev/usage/subscribing_customers\",\"className\":\"block px-3 py-1 text-sm rounded-md hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors text-gray-600 dark:text-gray-400\",\"children\":\"Subscribing Customers\"}]}],[\"$\",\"li\",\"/usage/add_payment_method_to_customer\",{\"children\":[\"$\",\"$L10\",null,{\"href\":\"/docs/dev/usage/add_payment_method_to_customer\",\"className\":\"block px-3 py-1 text-sm rounded-md hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors text-gray-600 dark:text-gray-400\",\"children\":\"Payment Methods\"}]}],[\"$\",\"li\",\"/usage/managing_subscriptions\",{\"children\":[\"$\",\"$L10\",null,{\"href\":\"/docs/dev/usage/managing_subscriptions\",\"className\":\"block px-3 py-1 text-sm rounded-md hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors text-gray-600 dark:text-gray-400\",\"children\":\"Managing Subscriptions\"}]}],\"$L15\",\"$L16\"]}]]}],\"$L17\"]}]]}]}],\"$L18\"]}]}]]}]\n"])</script><script>self.__next_f.push([1,"15:[\"$\",\"li\",\"/usage/using_stripe_checkout\",{\"children\":[\"$\",\"$L10\",null,{\"href\":\"/docs/dev/usage/using_stripe_checkout\",\"className\":\"block px-3 py-1 text-sm rounded-md hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors text-gray-600 dark:text-gray-400\",\"children\":\"Stripe Checkout\"}]}]\n16:[\"$\",\"li\",\"/usage/manually_syncing_with_stripe\",{\"children\":[\"$\",\"$L10\",null,{\"href\":\"/docs/dev/usage/manually_syncing_with_stripe\",\"className\":\"block px-3 py-1 text-sm rounded-md hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors text-gray-600 dark:text-gray-400\",\"children\":\"Manual Syncing\"}]}]\n"])</script><script>self.__next_f.push([1,"17:[\"$\",\"li\",\"/project\",{\"children\":[[\"$\",\"$L10\",null,{\"href\":\"/docs/dev/project\",\"className\":\"block px-3 py-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors \",\"children\":\"Project\"}],[\"$\",\"ul\",null,{\"className\":\"ml-4 mt-2 space-y-1\",\"children\":[[\"$\",\"li\",\"/project/contributing\",{\"children\":[\"$\",\"$L10\",null,{\"href\":\"/docs/dev/project/contributing\",\"className\":\"block px-3 py-1 text-sm rounded-md hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors text-gray-600 dark:text-gray-400\",\"children\":\"Contributing\"}]}],[\"$\",\"li\",\"/project/support\",{\"children\":[\"$\",\"$L10\",null,{\"href\":\"/docs/dev/project/support\",\"className\":\"block px-3 py-1 text-sm rounded-md hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors text-gray-600 dark:text-gray-400\",\"children\":\"Support\"}]}],[\"$\",\"li\",\"/project/authors\",{\"children\":[\"$\",\"$L10\",null,{\"href\":\"/docs/dev/project/authors\",\"className\":\"block px-3 py-1 text-sm rounded-md hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors text-gray-600 dark:text-gray-400\",\"children\":\"Authors\"}]}]]}]]}]\n"])</script><script>self.__next_f.push([1,"18:[\"$\",\"main\",null,{\"className\":\"flex-1 max-w-4xl\",\"children\":[\"$\",\"article\",null,{\"className\":\"prose prose-lg dark:prose-invert max-w-none\",\"children\":\"$L19\"}]}]\n"])</script><script>self.__next_f.push([1,"19:[[\"$\",\"h1\",null,{\"children\":\"Upgrading dj-stripe Smooth and Carefully\"}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"Background\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"In this article, we will share how to upgrade the \",[\"$\",\"code\",null,{\"children\":\"dj-stripe\"}],\" package flawlessly and carefully.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"!!! attention \\\"Important Note\\\"\\nPlease keep in mind that \",[\"$\",\"code\",null,{\"children\":\"dj-stripe\"}],\" always squashes the migration files.\\nWhich means its migration files are completely changed, and leading to migration issues.\\n\",[\"$\",\"strong\",null,{\"children\":[\"So, you can't immediately upgrade your package too far, for example, from \",[\"$\",\"code\",null,{\"children\":\"2.4.0\"}],\" to \",[\"$\",\"code\",null,{\"children\":\"2.7.0\"}],\" because it will cause breaking changes, especially in your database migrations.\"]}]]}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"How to do it?\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"For example, if your \",[\"$\",\"code\",null,{\"children\":\"dj-stripe\"}],\" version is \",[\"$\",\"code\",null,{\"children\":\"2.4.0\"}],\" and your migration files are referring to the old version.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"img\",null,{\"src\":\"https://github.com/agusmakmun/agusmakmun.github.io/assets/7134451/d433d048-d3cf-4385-a7f6-f1890acfe206\",\"alt\":\"old migration file\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"First, you need to find which version has that old migration. For example:\"}],\"\\n\",[\"$\",\"ol\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"Search for the latest version that is closest to your package version, for example: \",[\"$\",\"code\",null,{\"children\":\"2.4.0\"}],\" to \",[\"$\",\"code\",null,{\"children\":\"2.5.0\"}],\".\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"Visit this link to find it: \",[\"$\",\"a\",null,{\"href\":\"https://github.com/dj-stripe/dj-stripe/releases\",\"children\":\"https://github.com/dj-stripe/dj-stripe/releases\"}]]}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Cross-check the release notes.\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"Find which dj-stripe version is still compatible with your migration file, for example: \",[\"$\",\"code\",null,{\"children\":\"0006_2_3.py\"}],\".\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"Find the last migration file of the latest version at \",[\"$\",\"a\",null,{\"href\":\"https://github.com/dj-stripe/dj-stripe/tree/2.5.0/djstripe/migrations\",\"children\":\"https://github.com/dj-stripe/dj-stripe/tree/2.5.0/djstripe/migrations\"}],\" (for example: \",[\"$\",\"code\",null,{\"children\":\"0008_2_5.py\"}],\") (both files must exist; if not, it means the new version is no longer compatible with your version).\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"table\",null,{\"children\":[[\"$\",\"thead\",null,{\"children\":[\"$\",\"tr\",null,{\"children\":[[\"$\",\"th\",null,{\"children\":\"Old Migration\"}],[\"$\",\"th\",null,{\"children\":\"New Migration\"}]]}]}],[\"$\",\"tbody\",null,{\"children\":[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":[\"$\",\"img\",null,{\"src\":\"https://github.com/agusmakmun/agusmakmun.github.io/assets/7134451/6958e5a5-2e6d-4dd7-a9e3-5f067a819378\",\"alt\":\"old migration\"}]}],[\"$\",\"td\",null,{\"children\":[\"$\",\"img\",null,{\"src\":\"https://github.com/agusmakmun/agusmakmun.github.io/assets/7134451/4b075b78-5a34-4ed5-a23a-7dd1c8884bfa\",\"alt\":\"new migration\"}]}]]}]}]]}],\"\\n\",[\"$\",\"ol\",null,{\"start\":\"6\",\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"Update your \",[\"$\",\"code\",null,{\"children\":\"requirements.txt\"}],\" file from \",[\"$\",\"code\",null,{\"children\":\"dj-stripe==2.4.0\"}],\" to \",[\"$\",\"code\",null,{\"children\":\"dj-stripe==2.5.0\"}]]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"Run the \",[\"$\",\"code\",null,{\"children\":\"manage.py migrate djstripe\"}],\" command \",[\"$\",\"em\",null,{\"children\":\"(this command must not fail; if it does, cross-check steps 1-6).\"}]]}],\"\\n\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"hljs language-bash\",\"children\":\"(env-my-project) ➜  my-project git:(development) ✗ docker-compose -f local.yml run django python manage.py migrate djstripe\\n[+] Creating 3/0\\n ✔ Container my-project-redis-1     Running                                                                                                                                                                                  0.0s\\n ✔ Container my-project-mailhog-1   Running                                                                                                                                                                                  0.0s\\n ✔ Container my-project-postgres-1  Running                                                                                                                                                                                  0.0s\\nPostgreSQL is available\\nSystem check identified some issues:\\n\\nOperations to perform:\\n  Apply all migrations: djstripe\\nRunning migrations:\\n  Applying djstripe.0008_2_5... OK\\n\"}]}],\"\\n\",\"$L1a\",\"\\n\",\"$L1b\",\"\\n\",\"$L1c\",\"\\n\",\"$L1d\",\"\\n\",\"$L1e\",\"\\n\",\"$L1f\",\"\\n\",\"$L20\",\"\\n\",\"$L21\",\"\\n\",\"$L22\"]\n"])</script><script>self.__next_f.push([1,"1a:[\"$\",\"ol\",null,{\"start\":\"8\",\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"And then, after migrating it, change your migration file to refer to the new version (e.g., from \",[\"$\",\"code\",null,{\"children\":\"0006_2_3\"}],\" to \",[\"$\",\"code\",null,{\"children\":\"0008_2_5\"}],\").\"]}],\"\\n\"]}]\n1b:[\"$\",\"p\",null,{\"children\":[\"$\",\"img\",null,{\"src\":\"https://github.com/agusmakmun/agusmakmun.github.io/assets/7134451/70ebe2d4-d780-4994-b05b-e361fc95dd3d\",\"alt\":\"change migration file\"}]}]\n1c:[\"$\",\"ol\",null,{\"start\":\"9\",\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"Repeat the same process for higher version.\"}],\"\\n\"]}]\n1d:[\"$\",\"p\",null,{\"children\":[\"If you have an issue with the Stripe version, we can also try upgrading it in the \",[\"$\",\"code\",null,{\"children\":\"requirements.txt\"}],\" file.\\nCheck out this issue for more information: \",[\"$\",\"a\",null,{\"href\":\"https://github.com/dj-stripe/dj-stripe/issues/1842#issuecomment-1319185657\",\"children\":\"https://github.com/dj-stripe/dj-stripe/issues/1842#issuecomment-1319185657\"}],\".\"]}]\n1e:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"hljs language-txt\",\"children\":\"stripe\u003e=4.0.0,\u003c5.0.0  # https://github.com/dj-stripe/dj-stripe/issues/1842#issuecomment-1319185657\\n\"}]}]\n1f:[\"$\",\"h2\",null,{\"children\":\"Conclusion\"}]\n"])</script><script>self.__next_f.push([1,"20:[\"$\",\"ol\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"Find the closest version that compatible with your version \",[\"$\",\"em\",null,{\"children\":\"(for doing migration)\"}],\".\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"Update the dependency in \",[\"$\",\"code\",null,{\"children\":\"requirements.txt\"}],\" file and then deploy it.\",\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"Don't forget to run the \",[\"$\",\"code\",null,{\"children\":\"python manage.py migrate djstripe\"}],\" command.\"]}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"Change your migration file to refer to the new version (e.g., from \",[\"$\",\"code\",null,{\"children\":\"0006_2_3\"}],\" to \",[\"$\",\"code\",null,{\"children\":\"0008_2_5\"}],\"), and then deploy it.\"]}],\"\\n\"]}]\n"])</script><script>self.__next_f.push([1,"21:[\"$\",\"h2\",null,{\"children\":\"Alternatives\"}]\n22:[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"https://stackoverflow.com/a/31122841\",\"children\":\"https://stackoverflow.com/a/31122841\"}]}],\"\\n\"]}]\n"])</script></body></html>